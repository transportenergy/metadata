# Specification of the iTEM MIP3 data template
#
# Each specification has:
# - measure: see measures.yaml. A measure may be repeated in multiple specs.
# - dims: zero or more dimensions. All specifications implicitly have the
#         dimensions Model, Scenario, Region, and Year.
# - exclude: Pandas query() syntax for keys to exclude from the specification/
#            template. More than one may be given. See http://pandas.pydata.org/
#            pandas-docs/stable/reference/api/pandas.DataFrame.query.html


# General exclusions that apply to any measure including these dimensions
- exclude:
  # Vehicle types are only relevant for road modes
  - mode != 'road' and vehicle != 'all'
  # Vehicle types for freight only
  - type == 'passenger' and vehicle == 'truck'
  # Vehicle types for passengers only
  - type == 'freight' and vehicle in ['ldv', 'bus', '2w+3w']
  # Air freight is (largely) provided as a byproduct of passenger service; most
  # models do not include it separately
  - type == 'freight' and mode == 'air'
  # Assume hybrid and fuel cell technologies not used for air, rail, water, or
  # small road vehicles
  - mode in ['air', 'rail', 'water'] and technology in ['hybrid', 'fc']
  - vehicle == '2w+3w' and technology in ['hybrid', 'fc']
  # Combustion powertrains do not take electricity as an input
  - technology == 'combustion' and fuel == 'electricity'
  # Fuel cell powertrains take only hydrogen as an input
  - technology == 'fc' and fuel != 'hydrogen'
  # Electric powertrains take only electricity as an input
  - technology == 'electric' and fuel != 'electricity'
  # Shared and automated vehicles only relevant for LDVs
  - vehicle != ['ldv'] and automation == 'av'
  - vehicle == '2w+3w' and operator == 'hire'
  - vehicle not in ['ldv', '2w+3w'] and operator == 'own'


- measure: gdp

- measure: population

- measure: price
  dims: [pollutant]
  exclude:
  - pollutant != 'ghg'

- measure: price
  dims: [fuel]
  exclude:
  - fuel not in ['gasoline', 'diesel', 'electricity']

- measure: activity_veh
  dims: [type, mode, vehicle, technology, automation, operator]
  exclude: &excl-act
  # Omit sums by technology across modes
  - mode == 'all' and technology != 'all'

- measure: activity
  dims: [type, mode, vehicle, technology, automation, operator]
  exclude: *excl-act

- measure: energy
  dims: [type, mode, vehicle, technology, fuel]

- measure: emissions
  dims: [type, mode, vehicle, technology, fuel, pollutant, lca_scope]
  exclude:
  # No use-phase emissions from electricity
  - lca_scope == 'ttw' and fuel == 'electricity'
  # Not concerned with e.g. HFC emissions from refrigerants, or CHâ‚„ emissions
  # at service stations; typically assigned to non-transport sectors even in
  # models that include them.
  - lca_scope == 'wtt'
  - lca_scope == 'wtw' and technology != 'all'
  # No totals across AQ species
  - pollutant == 'aq'
  # Only use-phase emissions of air quality pollutants
  - pollutant in ['bc', 'nox', 'pm25', 'so2'] and lca_scope != 'ttw'

- measure: intensity
  dims: [type, mode, vehicle, technology, fleet]
  exclude:
  - fleet == 'used'

- measure: sales
  dims: [type, mode, vehicle, technology, fleet]
  exclude: &excl2
  # Omit sales of non-road vehicles
  - mode != 'road'
  - fleet == 'all'

- measure: stock
  dims: [type, mode, vehicle, technology]
  exclude:
  - mode != 'road'
  - fleet != 'all'

- measure: load_factor
  dims: [type, mode, vehicle, technology]
  exclude:
  # Omit load factors by individual technologies
  - technology != 'all'
